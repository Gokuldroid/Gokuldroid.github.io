{"componentChunkName":"component---src-components-module-blog-post-index-jsx","path":"/posts/being-a-privileged-website/","result":{"data":{"post":{"html":"<p>We all know that not everyone in this world is having equal privileges. I have spent quite a lot of time fixing IE bugs in my early stage of my career. It is super frustrating to handle all edge cases for all supported versions of every famous browsers. But do you believe that even websites doesn't have equal privileges in the browsers that we use in our day to day life?. Yes, it is true. the same code and same business logic might not work in the exact same browser, if you deploy it in the different domain. read more to understand what I am talking about</p>\n<p>you might know webkit already if you're frontend developer. incase if you don't know about it already.</p>\n<blockquote>\n<p>WebKit is a cross-platform web browser engine. On iOS and macOS, it powers Safari, Mail, iBooks, and many other applications. </p>\n</blockquote>\n<p>Recently, apple made <a href=\"https://github.com/WebKit/WebKit\">it</a> open source in github. by digging at it's <a href=\"https://github.com/WebKit/WebKit/blob/main/Source/WebCore/page/Quirks.cpp?s=08\">source</a> we can find some interesting stuffs.</p>\n<p>For example this one, on a hindsight it tries to suppress native auto correction in google docs. but why does even a browser engine developed by apple originally having some hacks to support a feature developed by google using some hacks. surprising isn't it?. </p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">shouldSuppressAutocorrectionAndAutocaptializationInHiddenEditableAreasForHost</span><span class=\"token punctuation\">(</span>StringView host<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">PLATFORM</span><span class=\"token punctuation\">(</span>IOS_FAMILY<span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">equalLettersIgnoringASCIICase</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> <span class=\"token string\">\"docs.google.com\"</span>_s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n    <span class=\"token function\">UNUSED_PARAM</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Need more?</p>\n<p>here are some examples,</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token comment\">// FIXME: Remove after the site is fixed, &lt;rdar://problem/75792913></span>\n<span class=\"token keyword\">bool</span> <span class=\"token class-name\">Quirks</span><span class=\"token operator\">::</span><span class=\"token function\">shouldHideSearchFieldResultsButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">ENABLE</span><span class=\"token punctuation\">(</span>IOS_FORM_CONTROL_REFRESH<span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">needsQuirks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">topPrivatelyControlledDomain</span><span class=\"token punctuation\">(</span>m_document<span class=\"token operator\">-></span><span class=\"token function\">topDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">host</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"google.\"</span>_s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>They even have special handling with CSS class name.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">bool</span> <span class=\"token class-name\">Quirks</span><span class=\"token operator\">::</span><span class=\"token function\">shouldMakeTouchEventNonCancelableForTarget</span><span class=\"token punctuation\">(</span>EventTarget<span class=\"token operator\">*</span> target<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">needsQuirks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">auto</span> host <span class=\"token operator\">=</span> m_document<span class=\"token operator\">-></span><span class=\"token function\">topDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">host</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">equalLettersIgnoringASCIICase</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> <span class=\"token string\">\"www.youtube.com\"</span>_s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is<span class=\"token operator\">&lt;</span>Element<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">unsigned</span> depth <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">auto</span><span class=\"token operator\">*</span> element <span class=\"token operator\">=</span> downcast<span class=\"token operator\">&lt;</span>Element<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> element <span class=\"token operator\">&amp;&amp;</span> depth<span class=\"token punctuation\">;</span> element <span class=\"token operator\">=</span> element<span class=\"token operator\">-></span><span class=\"token function\">parentElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">--</span>depth<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element<span class=\"token operator\">-></span><span class=\"token function\">localName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"paper-item\"</span>_s <span class=\"token operator\">&amp;&amp;</span> element<span class=\"token operator\">-></span><span class=\"token function\">classList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yt-dropdown-menu\"</span>_s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>And this one,</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">isKinjaLoginAvatarElement</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> Element<span class=\"token operator\">&amp;</span> element<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// The click event handler has been found to trigger on a div or</span>\n    <span class=\"token comment\">// span with these class names, or the svg, or the svg's path.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span><span class=\"token function\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">auto</span><span class=\"token operator\">&amp;</span> classNames <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">classNames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>classNames<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"js_switch-to-burner-login\"</span>_s<span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">||</span> classNames<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"js_header-userbutton\"</span>_s<span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">||</span> classNames<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sc-1il3uru-3\"</span>_s<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> classNames<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cIhKfd\"</span>_s<span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">||</span> classNames<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"iyvn34-0\"</span>_s<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> classNames<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bYIjtl\"</span>_s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> Element<span class=\"token operator\">*</span> svgElement <span class=\"token operator\">=</span> <span class=\"token keyword\">nullptr</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is<span class=\"token operator\">&lt;</span>SVGSVGElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        svgElement <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>element<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is<span class=\"token operator\">&lt;</span>SVGPathElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> is<span class=\"token operator\">&lt;</span>SVGSVGElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span><span class=\"token function\">parentElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        svgElement <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">parentElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>svgElement <span class=\"token operator\">&amp;&amp;</span> svgElement<span class=\"token operator\">-></span><span class=\"token function\">hasAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">auto</span> ariaLabelAttr <span class=\"token operator\">=</span> svgElement<span class=\"token operator\">-></span><span class=\"token function\">attributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNamedItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"aria-label\"</span>_s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ariaLabelAttr <span class=\"token operator\">&amp;&amp;</span> ariaLabelAttr<span class=\"token operator\">-></span><span class=\"token function\">value</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"UserFilled icon\"</span>_s<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>A sample PR description of a frustrated developer</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"><code class=\"language-txt\"> Regression(252759@main) Unable to log into pandora.com\n\nhttps://bugs.webkit.org/show_bug.cgi?id=246430\nrdar://100243111\n\nReviewed by Geoffrey Garen and Ryosuke Niwa.\n\nWe&#39;re unable to log into pandora.com since un-exposing window.showModalDialog()\nin 252759@main. Pandora does not actually seem to call showModalDialog() but\nthey are calling its getter on the Window object. It is unclear why this is\ncausing log in to fail since there is no JS error (and other browsers don&#39;t\nexpose showModalDialog either).\n\nTo resolve the issue for now, I am adding a quirk to re-expose showModalDialog\non pandora.com. However, since they&#39;re not calling it, I am merely using\n`undefined` as value for the property.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>you can find full source code for these hacks <a href=\"https://github.com/WebKit/WebKit/blob/main/Source/WebCore/page/Quirks.cpp?s=08\">here</a>. If you ever find a bug in your site that doesn't work for some reason, don't try fix it in your code. <a href=\"https://github.com/WebKit/WebKit/commit/93d276254db4805331fa1eb9465f70d6d1b43c33\">fix</a> it in the browser engine itself like a <a href=\"https://github.com/WebKit/WebKit/commit/93d276254db4805331fa1eb9465f70d6d1b43c33\">pro frontend developer</a> and have a life with your pet dog or GF. Happy monday frontend folks :).</p>","excerpt":"We all know that not everyone in this world is having equal privileges. I have spent quite a lot of time fixing IE bugs in my early stage of…","tableOfContents":"","frontmatter":{"title":"Being a privileged website","path":"being-a-privileged-website","tags":["programming","software development"],"parentPath":null}},"parentPost":null,"siblingPosts":{"edges":[]},"previousPost":null,"nextPost":{"frontmatter":{"title":"Ostrich algorithm"}}},"pageContext":{"parentPath":null,"pageId":"3873ba6a-8c0a-59fc-abd5-c04ee7519ea8","previousPagePath":"","previousPageId":"","nextPagePath":"/posts/til-ostrich-algorithm/","nextItem":{"node":{"id":"08beb610-2485-527b-942c-a259bbdc4a80","frontmatter":{"title":"Ostrich algorithm","path":"til-ostrich-algorithm","parentPath":null,"date":"2022-10-02T07:58:25.000Z","categories":["today I learned","algorithm"]}},"context":{"parentPath":null}},"nextPageId":"08beb610-2485-527b-942c-a259bbdc4a80"}},"staticQueryHashes":["3128451518"]}